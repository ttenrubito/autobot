<?php
/**
 * TextProcessingService
 * 
 * ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ text extraction, cleanup, ‡πÅ‡∏•‡∏∞ keyword processing ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Thai/English
 * 
 * @package Autobot\Bot\Services
 * @version 1.0.0
 * @date 2026-02-05
 */

namespace Autobot\Bot\Services;

use Logger;

class TextProcessingService
{
    /**
     * üß† Smart Product Keyword Extraction
     * ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö patterns ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢
     * 
     * @param string $text Input text
     * @return string|null Extracted keywords or null
     */
    public function smartExtractProductKeywords(string $text): ?string
    {
        $text = trim($text);
        if (empty($text)) return null;
        
        // ===== Step 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô greeting/non-product =====
        if (preg_match('/^(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ|‡∏î‡∏µ|hello|hi|hey|‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì|‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à|thanks|bye|‡∏ö‡∏≤‡∏¢)[\s!‡∏Ñ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏∞‡∏Ñ‡∏∞‡∏à‡πâ‡∏≤‡∏ô‡∏∞]*$/iu', $text)) {
            return null;
        }
        
        // ===== Step 1.5: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô service request ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà product search =====
        // ‡∏ã‡πà‡∏≠‡∏°, ‡∏à‡∏≥‡∏ô‡∏≥, ‡∏ú‡πà‡∏≠‡∏ô, ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô, ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‚Üí ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà product search
        if (preg_match('/(‡∏ã‡πà‡∏≠‡∏°|‡∏à‡∏≥‡∏ô‡∏≥|‡∏ú‡πà‡∏≠‡∏ô|‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô|admin|‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠|‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö|‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢|‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°|‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á|‡πÑ‡∏ñ‡πà‡∏ñ‡∏≠‡∏ô|‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠|‡∏Ç‡∏≤‡∏¢|‡∏™‡πà‡∏á|‡∏à‡∏±‡∏î‡∏™‡πà‡∏á|‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà|tracking|‡πÅ‡∏ó‡∏£‡∏Ñ)/iu', $text)) {
            return null;
        }
        
        // ===== Step 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á stop words list ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô =====
        // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Å‡∏•‡∏∏‡πà‡∏°: ‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà vs ‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏ô/‡∏ó‡πâ‡∏≤‡∏¢
        $removeAnywhere = [
            // Question words (‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ space)
            '‡πÑ‡∏´‡∏°', '‡∏°‡∏±‡πâ‡∏¢', '‡∏ö‡πâ‡∏≤‡∏á', '‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏õ‡πà‡∏≤‡∏ß', '‡∏õ‡∏∞', '‡πÄ‡∏´‡∏£‡∏≠', '‡∏´‡∏£‡∏≠',
            '‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà', '‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£', '‡∏Å‡∏µ‡πà‡∏ö‡∏≤‡∏ó', '‡∏¢‡∏±‡∏á‡πÑ‡∏á', '‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£',
            // Polite particles (‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà)
            '‡∏Ñ‡∏£‡∏±‡∏ö', '‡∏Ñ‡πà‡∏∞', '‡∏Ñ‡∏∞', '‡∏Ñ‡∏±‡∏ö', '‡∏à‡πâ‡∏≤', '‡∏à‡πâ‡∏∞', '‡∏ô‡∏∞', '‡∏ô‡∏∞‡∏Ñ‡∏∞', '‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö', '‡∏ô‡πâ‡∏≤', '‡∏à‡πä‡∏∞',
            // Fillers (‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà)
            '‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏™‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏î‡πâ‡∏ß‡∏¢', '‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏™‡∏¥', '‡∏™‡∏¥', '‡∏ó‡∏µ',
        ];
        
        $removeFromEdges = [
            // Request verbs (‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏ô) - ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏ß‡πÑ‡∏õ‡∏™‡∏±‡πâ‡∏ô
            '‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡πÉ‡∏´‡πâ', '‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤', '‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡πâ', '‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏´‡∏≤', '‡∏£‡∏ö‡∏Å‡∏ß‡∏ô',
            '‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡πÉ‡∏´‡πâ', '‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π‡πÉ‡∏´‡πâ', '‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤', '‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π', '‡∏ä‡πà‡∏ß‡∏¢',
            '‡∏Ç‡∏≠‡∏î‡∏π', '‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π', '‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ', '‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏´‡πá‡∏ô', '‡∏≠‡∏¢‡∏≤‡∏Å‡∏ñ‡∏≤‡∏°',
            '‡∏ï‡∏≤‡∏°‡∏´‡∏≤', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤', '‡∏Ç‡∏≠‡∏ñ‡∏≤‡∏°', '‡∏ñ‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏ñ‡∏≤‡∏°',
            '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£', '‡∏™‡∏ô‡πÉ‡∏à', '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥', '‡∏£‡∏≤‡∏Ñ‡∏≤',
            '‡∏Ç‡∏≠', '‡∏´‡∏≤', '‡∏î‡∏π', '‡πÄ‡∏≠‡∏≤', '‡∏°‡∏µ', '‡∏û‡∏µ‡πà', '‡∏ô‡πâ‡∏≠‡∏á', '‡∏Ñ‡∏∏‡∏ì',
            // Fillers (‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏ô/‡∏ó‡πâ‡∏≤‡∏¢) - ‡∏£‡∏∞‡∏ß‡∏±‡∏á "‡πÉ‡∏´‡πâ" ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏≥
            '‡∏ó‡∏µ‡πà', '‡∏ï‡∏±‡∏ß', '‡∏≠‡∏±‡∏ô', '‡∏ä‡∏¥‡πâ‡∏ô', '‡πÅ‡∏ö‡∏ö',
        ];
        
        // Sort by length (longest first)
        usort($removeAnywhere, fn($a, $b) => mb_strlen($b) - mb_strlen($a));
        usort($removeFromEdges, fn($a, $b) => mb_strlen($b) - mb_strlen($a));
        
        $result = $text;
        
        // ===== Step 3a: ‡∏•‡∏ö phrases ‡∏Å‡πà‡∏≠‡∏ô (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ boundary) =====
        $removePhrases = ['‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡πÉ‡∏´‡πâ‡∏ó‡∏µ', '‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢'];
        foreach ($removePhrases as $phrase) {
            $result = str_replace($phrase, '', $result);
        }
        
        // ===== Step 3b: ‡∏•‡∏ö words ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà =====
        // ‡πÉ‡∏ä‡πâ word boundary matching ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏≥
        foreach ($removeAnywhere as $word) {
            // ‡πÉ‡∏ä‡πâ regex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Å‡∏ß‡πà‡∏≤ str_replace
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ space/‡∏Ñ‡∏≥‡∏≠‡∏∑‡πà‡∏ô
            $result = preg_replace('/' . preg_quote($word, '/') . '(?=\s|$)/u', '', $result);
        }
        
        // ===== Step 4: ‡∏•‡∏ö words ‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏ô/‡∏ó‡πâ‡∏≤‡∏¢ =====
        foreach ($removeFromEdges as $word) {
            $result = preg_replace('/^' . preg_quote($word, '/') . '\s*/u', '', $result);
            $result = preg_replace('/\s*' . preg_quote($word, '/') . '$/u', '', $result);
        }
        
        // ===== Step 5: Normalize whitespace =====
        $result = trim(preg_replace('/\s+/', ' ', $result));
        
        // ===== Step 6: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà product ‚Üí return null =====
        if (empty($result) || mb_strlen($result) < 2) {
            return null;
        }
        
        // ===== Step 7: Validate ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô product-related =====
        $productIndicators = $this->getProductIndicators();
        
        $hasProductIndicator = false;
        $lowerResult = mb_strtolower($result);
        foreach ($productIndicators as $indicator) {
            if (mb_strpos($lowerResult, mb_strtolower($indicator)) !== false) {
                $hasProductIndicator = true;
                break;
            }
        }
        
        if (!$hasProductIndicator && mb_strlen($result) < 4) {
            return null;
        }
        
        Logger::info('[TEXT_PROCESSING] Keywords extracted', [
            'input' => $text,
            'output' => $result
        ]);
        
        return $result;
    }
    
    /**
     * ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
     * ‡πÄ‡∏ä‡πà‡∏ô "‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ rolex" ‚Üí "‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ rolex"
     * 
     * @param string $text Input text
     * @return string Extracted keywords
     */
    public function extractProductKeywords(string $text): string
    {
        $text = trim($text);
        
        // ‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô greeting ‡∏´‡∏£‡∏∑‡∏≠ non-product ‚Üí return empty
        if (preg_match('/^(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ|‡∏î‡∏µ|hello|hi|hey|‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì|‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à|thanks|bye|‡∏ö‡∏≤‡∏¢)[\s!‡∏Ñ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏∞‡∏Ñ‡∏∞‡∏à‡πâ‡∏≤‡∏ô‡∏∞]*$/iu', $text)) {
            return '';
        }
        
        // ‡∏•‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏ó‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ)
        $removeWords = [
            // Request verbs
            '‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ', '‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π', '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£', '‡∏™‡∏ô‡πÉ‡∏à', '‡∏´‡∏≤', '‡∏Ç‡∏≠‡∏î‡∏π', '‡∏Ç‡∏≠', '‡πÄ‡∏≠‡∏≤', 
            '‡∏î‡∏π', '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥', '‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤', '‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π',
            // Question words
            '‡∏°‡∏µ', '‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏ö‡πâ‡∏≤‡∏á', '‡πÑ‡∏´‡∏°', '‡∏°‡∏±‡πâ‡∏¢', '‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏õ‡πà‡∏≤‡∏ß', '‡∏õ‡∏∞',
            // Polite particles
            '‡∏Ñ‡∏£‡∏±‡∏ö', '‡∏Ñ‡πà‡∏∞', '‡∏Ñ‡∏∞', '‡∏Ñ‡∏±‡∏ö', '‡∏à‡πâ‡∏≤', '‡∏ô‡∏∞', '‡∏à‡πâ‡∏∞', '‡∏ô‡∏∞‡∏Ñ‡∏∞', '‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö',
            // Fillers
            '‡∏î‡πâ‡∏ß‡∏¢', '‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏™‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢', '‡∏ó‡∏µ‡πà', '‡∏ï‡∏±‡∏ß', '‡∏≠‡∏±‡∏ô', '‡∏ä‡∏¥‡πâ‡∏ô'
        ];
        
        // Sort by length descending to remove longer phrases first
        usort($removeWords, function($a, $b) {
            return mb_strlen($b, 'UTF-8') - mb_strlen($a, 'UTF-8');
        });
        
        foreach ($removeWords as $word) {
            // ‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ
            $text = preg_replace('/^' . preg_quote($word, '/') . '\s*/u', '', $text);
            // ‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ó‡πâ‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ
            $text = preg_replace('/' . preg_quote($word, '/') . '\s*$/u', '', $text);
            // ‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô question words)
            if (in_array($word, ['‡∏ö‡πâ‡∏≤‡∏á', '‡πÑ‡∏´‡∏°', '‡∏°‡∏±‡πâ‡∏¢', '‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏£‡∏∂‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏õ‡πà‡∏≤‡∏ß', '‡∏õ‡∏∞'])) {
                $text = str_replace($word, ' ', $text);
            }
        }
        
        // Normalize whitespace
        $text = trim(preg_replace('/\s+/', ' ', $text));
        
        return $text;
    }
    
    /**
     * Extract product keywords from array of messages (fallback method)
     * 
     * @param array $messages Array of message strings
     * @return string Combined keywords
     */
    public function extractProductKeywordsFallback(array $messages): string
    {
        // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏Å
        $filtered = array_filter($messages, function($msg) {
            $msg = trim($msg);
            if (empty($msg)) return false;
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏≥‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß‡πÜ ‡∏≠‡∏≠‡∏Å
            if (preg_match('/^(‡∏Ñ‡∏£‡∏±‡∏ö|‡∏Ñ‡πà‡∏∞|‡∏Ñ‡∏∞|‡∏Ñ‡∏±‡∏ö|‡∏à‡πâ‡∏≤|‡πÇ‡∏≠‡πÄ‡∏Ñ|ok|k)+[!?.\s]*$/iu', $msg)) {
                return false;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á greeting ‡∏≠‡∏≠‡∏Å
            if (preg_match('/^(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ|‡∏î‡∏µ|‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö|‡∏î‡∏µ‡∏Ñ‡πà‡∏∞|‡∏î‡∏µ‡∏Ñ‡∏∞|hello|hi|hey)[\s!]*$/iu', $msg)) {
                return false;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á general inquiry ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
            if (preg_match('/^(‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£|‡∏Ç‡∏≤‡∏¢‡∏≠‡∏∞‡πÑ‡∏£|‡∏°‡∏µ‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á|‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏≤‡∏¢|‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)[\s\?!]*$/iu', $msg)) {
                return false;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á ack messages
            if (preg_match('/^(‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢|‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö|‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞|‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö|‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à|‡πÇ‡∏≠‡πÄ‡∏Ñ|‡∏ï‡∏Å‡∏•‡∏á|ok|okay)+[!\.\s]*$/iu', $msg)) {
                return false;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á thanks
            if (preg_match('/^(‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì|‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à|thanks|thank\s*you|‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô|‡πÑ‡∏ß‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô|‡∏ö‡∏≤‡∏¢|bye)+[!\.\s]*$/iu', $msg)) {
                return false;
            }
            
            return true;
        });
        
        // ‡∏ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£
        if (empty($filtered)) {
            return '';
        }
        
        // ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
        $productRelevantParts = [];
        foreach ($filtered as $msg) {
            $extracted = $this->extractProductKeywords($msg);
            if (!empty($extracted)) {
                $productRelevantParts[] = $extracted;
            }
        }
        
        // ‡∏ñ‡πâ‡∏≤‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÑ‡∏î‡πâ ‚Üí ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡πá‡∏°
        if (!empty($productRelevantParts)) {
            return implode(' ', array_unique($productRelevantParts));
        }
        
        return implode(' ', $filtered);
    }
    
    /**
     * Check if text looks like a product query (name, brand, model)
     * rather than a question or greeting
     * 
     * @param string $text Input text
     * @return bool True if looks like product query
     */
    public function looksLikeProductQuery(string $text): bool
    {
        $text = trim($text);
        $len = mb_strlen($text);
        
        // Too short or too long - probably not a product name
        if ($len < 3 || $len > 100) {
            return false;
        }
        
        // Skip if it's a question (contains question marks or Thai question words)
        if (preg_match('/[?Ôºü]/u', $text)) {
            return false;
        }
        if (preg_match('/^(‡∏ó‡∏≥‡πÑ‡∏°|‡∏≠‡∏∞‡πÑ‡∏£|‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô|‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà|‡∏¢‡∏±‡∏á‡πÑ‡∏á|‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£|‡πÑ‡∏´‡∏°|‡∏°‡∏±‡πâ‡∏¢|‡∏´‡∏£‡∏∑‡∏≠)/u', $text)) {
            return false;
        }
        
        // Skip common greetings/thanks
        if (preg_match('/^(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|‡∏î‡∏µ‡∏Ñ‡πà‡∏∞|‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö|‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì|‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à|hello|hi|hey|thanks)/iu', $text)) {
            return false;
        }
        
        // Skip common service requests (these have their own intents)
        if (preg_match('/(‡∏ã‡πà‡∏≠‡∏°|‡∏à‡∏≥‡∏ô‡∏≥|‡∏ú‡πà‡∏≠‡∏ô|‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô|admin|‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠)/u', $text)) {
            return false;
        }
        
        // ‚úÖ Positive signals: looks like product name/brand
        if ($this->containsBrandName($text)) {
            return true;
        }
        
        if ($this->containsModelIndicator($text)) {
            return true;
        }
        
        if ($this->containsLuxuryNickname($text)) {
            return true;
        }
        
        // Thai product category keywords
        if (preg_match('/(‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤|‡πÅ‡∏´‡∏ß‡∏ô|‡∏™‡∏£‡πâ‡∏≠‡∏¢|‡∏Å‡∏≥‡πÑ‡∏•|‡∏à‡∏µ‡πâ|‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π|‡πÄ‡∏û‡∏ä‡∏£|‡∏ó‡∏≠‡∏á|‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥|‡πÄ‡∏á‡∏¥‡∏ô|‡∏û‡∏•‡∏≠‡∏¢|‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å)/u', $text)) {
            return true;
        }
        
        // Mixed alphanumeric that might be product code/name
        if (preg_match('/^[A-Za-z0-9\s\-\.]+$/u', $text) && preg_match('/[A-Za-z]/u', $text)) {
            return true;
        }
        
        // Contains both English and Thai (common for product names)
        if (preg_match('/[A-Za-z]/u', $text) && preg_match('/[\x{0E00}-\x{0E7F}]/u', $text)) {
            return true;
        }
        
        return false;
    }
    
    /**
     * Fix truncated Thai text by adding proper ending
     * 
     * @param string $text Potentially truncated text
     * @return string Fixed text
     */
    public function fixTruncatedThaiText(string $text): string
    {
        $text = trim($text);
        
        if (empty($text)) {
            return $text;
        }
        
        // Get the last character
        $lastChar = mb_substr($text, -1, 1, 'UTF-8');
        
        // Thai ending particles and punctuation that indicate complete sentence
        $validEndings = ['‡∏Ñ‡πà‡∏∞', '‡∏Ñ‡∏£‡∏±‡∏ö', '‡∏Ñ‡∏∞', '‡∏ô‡∏∞', '‡∏à‡πâ‡∏≤', '‡∏à‡πâ‡∏∞', '‡∏Ñ‡πà‡∏≤', '‡∏ô‡∏∞‡∏Ñ‡∏∞', '‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö'];
        $validEndChars = ['!', '?', '.', '„ÄÇ', ')', 'Ôºâ', '"', "'", 'üòä', 'üôè', '‚ú®', 'üíé', 'üì∏', 'üòç'];
        
        // Check for Thai sentence-final particles
        foreach ($validEndings as $ending) {
            if (mb_substr($text, -mb_strlen($ending, 'UTF-8'), null, 'UTF-8') === $ending) {
                return $text; // Properly ended
            }
        }
        
        // Check for valid ending punctuation/emoji
        if (in_array($lastChar, $validEndChars)) {
            return $text; // Properly ended
        }
        
        // Check if ends with emoji (2-4 bytes for most emojis)
        if (preg_match('/[\x{1F600}-\x{1F64F}\x{1F680}-\x{1F6FF}\x{2600}-\x{26FF}\x{2700}-\x{27BF}]$/u', $text)) {
            return $text; // Ends with emoji
        }
        
        // Log warning for potentially truncated text
        Logger::warning('[TEXT_PROCESSING] Text appears truncated', [
            'text_length' => mb_strlen($text, 'UTF-8'),
            'last_chars' => mb_substr($text, -10, 10, 'UTF-8'),
        ]);
        
        // Add polite ending to make it look intentional
        $text .= '‡∏Ñ‡πà‡∏∞';
        
        return $text;
    }
    
    /**
     * Check if text contains known brand names
     * ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÅ‡∏•‡∏∞‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏ó‡∏¢
     */
    public function containsBrandName(string $text): bool
    {
        // Watch brands
        $watchBrands = 'rolex|‡πÇ‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏ã‡πå|omega|‡πÇ‡∏≠‡πÄ‡∏°‡∏Å‡πâ‡∏≤|patek|‡∏õ‡∏≤‡πÄ‡∏ï‡πá‡∏Å|cartier|‡∏Ñ‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏£‡πå';
        $watchBrands .= '|audemars|‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏°‡∏≤‡∏£‡πå|richard mille|‡∏£‡∏¥‡∏ä‡∏≤‡∏£‡πå‡∏î|hublot|‡∏≠‡∏π‡πÇ‡∏ö‡∏•‡∏ï‡πå';
        $watchBrands .= '|iwc|panerai|‡∏û‡∏≤‡πÄ‡∏ô‡∏≠‡πÑ‡∏£|breitling|‡πÑ‡∏ö‡∏£‡∏ó‡πå‡∏•‡∏¥‡πà‡∏á|tag heuer|tagheuer|‡πÅ‡∏ó‡πá‡∏Å‡∏Æ‡∏≠‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå';
        $watchBrands .= '|tissot|‡∏ó‡∏¥‡∏™‡πÇ‡∏ã‡∏ï‡πå|seiko|‡πÑ‡∏ã‡πÇ‡∏Å‡πâ|citizen|‡∏ã‡∏¥‡∏ï‡∏¥‡πÄ‡∏ã‡πà‡∏ô|casio|‡∏Ñ‡∏≤‡∏™‡∏¥‡πÇ‡∏≠|g-shock|‡∏à‡∏µ‡∏ä‡πá‡∏≠‡∏Ñ';
        $watchBrands .= '|tudor|‡∏ó‡∏¥‡∏ß‡∏î‡∏≠‡∏£‡πå|longines|‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏™‡πå|chopard|‡πÇ‡∏ä‡∏û‡∏≤‡∏£‡πå‡∏î';
        
        // Jewelry brands
        $jewelryBrands = 'bvlgari|bulgari|‡∏ö‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏µ|tiffany|‡∏ó‡∏¥‡∏ü‡∏ü‡∏≤‡∏ô‡∏µ‡πà|chanel|‡∏ä‡∏≤‡πÅ‡∏ô‡∏•';
        $jewelryBrands .= '|van cleef|‡πÅ‡∏ß‡∏ô‡∏Ñ‡∏•‡∏µ‡∏ü|piaget|‡πÄ‡∏û‡∏µ‡∏¢‡πÄ‡∏à‡∏ï‡πå|gucci|‡∏Å‡∏∏‡∏ä‡∏ä‡∏µ‡πà';
        $jewelryBrands .= '|lv|louis vuitton|‡∏´‡∏•‡∏∏‡∏¢‡∏™‡πå|hermes|‡πÅ‡∏≠‡∏£‡πå‡πÄ‡∏°‡∏™|dior|‡∏î‡∏¥‡∏≠‡∏≠‡∏£‡πå';
        $jewelryBrands .= '|pandora|‡πÅ‡∏û‡∏ô‡∏î‡∏≠‡∏£‡πà‡∏≤|swarovski|‡∏™‡∏ß‡∏≤‡∏£‡∏≠‡∏ü‡∏™‡∏Å‡∏µ‡πâ';
        
        $pattern = '/(' . $watchBrands . '|' . $jewelryBrands . ')/iu';
        return (bool)preg_match($pattern, $text);
    }
    
    /**
     * Check if text contains watch/jewelry model indicators
     * ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∏‡πà‡∏ô‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤, ‡∏•‡∏≤‡∏¢‡∏™‡∏£‡πâ‡∏≠‡∏¢, ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏£‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
     */
    public function containsModelIndicator(string $text): bool
    {
        // Watch models
        $watchModels = 'submariner|‡∏ã‡∏±‡∏ö‡∏°‡∏≤‡∏£‡∏µ‡∏ô|daytona|‡πÄ‡∏î‡∏¢‡πå‡πÇ‡∏ó‡∏ô‡πà‡∏≤|datejust|‡πÄ‡∏î‡∏ó‡∏à‡∏±‡∏™‡∏ï‡πå';
        $watchModels .= '|gmt|speedmaster|‡∏™‡∏õ‡∏µ‡∏î‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå|seamaster|‡∏ã‡∏µ‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå';
        $watchModels .= '|nautilus|‡∏ô‡∏≠‡∏ï‡∏¥‡∏•‡∏∏‡∏™|royal oak|‡∏£‡∏≠‡∏¢‡∏±‡∏•‡πÇ‡∏≠‡πä‡∏Ñ|aquanaut|‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏ô‡πá‡∏≠‡∏ó';
        $watchModels .= '|oyster|‡∏≠‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå|perpetual|chronograph|‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü';
        $watchModels .= '|explorer|‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡∏û‡∏•‡∏≠‡πÄ‡∏£‡∏≠‡∏£‡πå|yacht master|‡∏¢‡∏≠‡∏ä‡∏ó‡πå‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå';
        $watchModels .= '|sky dweller|‡∏™‡∏Å‡∏≤‡∏¢‡∏î‡πÄ‡∏ß‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå|day date|‡πÄ‡∏î‡∏¢‡πå‡πÄ‡∏î‡∏ó|president|‡πÄ‡∏û‡∏£‡∏™‡∏ã‡∏¥‡πÄ‡∏î‡∏ô‡∏ó‡πå';
        
        // Necklace chain patterns (‡∏•‡∏≤‡∏¢‡∏™‡∏£‡πâ‡∏≠‡∏¢)
        $chainPatterns = '‡∏•‡∏≤‡∏¢‡πÇ‡∏ã‡πà|‡∏•‡∏≤‡∏¢‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤|‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡∏á‡∏π|‡∏•‡∏≤‡∏¢‡∏ö‡∏≤‡∏£‡πå|‡∏•‡∏≤‡∏¢‡∏ï‡∏∞‡∏Ç‡∏≠|‡∏•‡∏≤‡∏¢‡πÇ‡∏≠‡πà‡∏á';
        $chainPatterns .= '|‡∏•‡∏≤‡∏¢‡πÄ‡∏ö‡∏ô‡∏ã‡πå|‡∏•‡∏≤‡∏¢‡∏ã‡∏µ‡∏ï‡∏£‡∏≠‡∏á|‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏¥‡πà‡∏á|‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡∏µ‡∏¢|‡∏•‡∏≤‡∏¢‡∏ö‡∏¥‡∏î';
        
        // Amulet types (‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏£‡∏∞)
        $amuletTypes = '‡∏û‡∏£‡∏∞‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à|‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à|‡∏û‡∏£‡∏∞‡∏õ‡∏¥‡∏î‡∏ï‡∏≤|‡∏õ‡∏¥‡∏î‡∏ï‡∏≤|‡∏û‡∏£‡∏∞‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô|‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô';
        $amuletTypes .= '|‡∏û‡∏£‡∏∞‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤|‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤|‡∏û‡∏£‡∏∞‡∏£‡∏≠‡∏î|‡∏û‡∏£‡∏∞‡∏ã‡∏∏‡πâ‡∏°‡∏Å‡∏≠|‡∏û‡∏£‡∏∞‡∏ú‡∏á‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì';
        $amuletTypes .= '|‡∏û‡∏£‡∏∞‡∏Å‡∏£‡∏¥‡πà‡∏á|‡∏Å‡∏£‡∏¥‡πà‡∏á|‡∏û‡∏£‡∏∞‡∏ä‡∏±‡∏¢‡∏ß‡∏±‡∏í‡∏ô‡πå|‡∏û‡∏£‡∏∞‡∏Å‡∏•‡∏µ‡∏ö‡∏ö‡∏±‡∏ß|‡∏û‡∏£‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏•‡∏Å';
        $amuletTypes .= '|‡∏û‡∏£‡∏∞‡∏û‡∏∏‡∏ó‡∏ò‡∏ä‡∏¥‡∏ô‡∏£‡∏≤‡∏ä|‡∏ä‡∏¥‡∏ô‡∏£‡∏≤‡∏ä|‡∏û‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏£‡∏Å‡∏ï|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà';
        $amuletTypes .= '|‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠|‡∏£‡∏∏‡πà‡∏ô‡πÅ‡∏£‡∏Å|‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ô‡∏¥‡∏¢‡∏°|‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà|‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å|‡πÄ‡∏ö‡∏ç‡∏à‡∏†‡∏≤‡∏Ñ‡∏µ';
        
        // ‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà/‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏î‡∏±‡∏á
        $famousMonks = '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ó‡∏ß‡∏î|‡∏ó‡∏ß‡∏î|‡∏õ‡∏π‡πà‡∏ó‡∏ß‡∏î|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏ó‡∏ß‡∏î|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ó‡∏¥‡∏°|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏´‡∏°‡∏∏‡∏ô';
        $famousMonks .= '|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏î‡∏π‡πà|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡πÄ‡∏à‡∏∑‡∏≠|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ö‡∏∏‡∏ç|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏´‡∏•‡∏¥‡∏ß|‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏®‡∏∏‡∏Ç';
        $famousMonks .= '|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏Ñ‡∏π‡∏ì|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÄ‡∏á‡∏¥‡∏ô|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÇ‡∏™‡∏ò‡∏£|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏û‡∏£‡∏´‡∏°';
        $famousMonks .= '|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏Å‡∏ß‡∏¢|‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏£‡∏ß‡∏¢|‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡πÇ‡∏ï';
        $famousMonks .= '|‡∏û‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢|‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏£';
        
        // ‡∏ß‡∏±‡∏î‡∏î‡∏±‡∏á
        $famousTemples = '‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏Ü‡∏±‡∏á|‡∏ß‡∏±‡∏î‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥|‡∏ß‡∏±‡∏î‡πÄ‡∏Å‡∏®‡πÑ‡∏ä‡πÇ‡∏¢|‡∏ß‡∏±‡∏î‡πÉ‡∏´‡∏ç‡πà|‡∏ß‡∏±‡∏î‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤';
        $famousTemples .= '|‡∏ß‡∏±‡∏î‡∏ä‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ|‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏|‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏Ç‡∏∏‡∏ô‡∏û‡∏£‡∏´‡∏°|‡∏ß‡∏±‡∏î‡∏£‡∏≤‡∏ä‡∏ö‡∏û‡∏¥‡∏ò';
        $famousTemples .= '|‡∏ß‡∏±‡∏î‡∏™‡∏∏‡∏ó‡∏±‡∏®‡∏ô‡πå|‡∏ß‡∏±‡∏î‡∏ö‡∏ß‡∏£‡∏ô‡∏¥‡πÄ‡∏ß‡∏®|‡∏ß‡∏±‡∏î‡∏û‡∏•‡∏±‡∏ö|‡∏ß‡∏±‡∏î‡∏´‡∏ô‡∏≠‡∏á‡πÇ‡∏û|‡∏ß‡∏±‡∏î‡∏ó‡πà‡∏≤‡∏ã‡∏∏‡∏á';
        
        // Ring types
        $ringTypes = '‡πÅ‡∏´‡∏ß‡∏ô‡∏´‡∏°‡∏±‡πâ‡∏ô|‡πÅ‡∏´‡∏ß‡∏ô‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô|‡πÅ‡∏´‡∏ß‡∏ô‡∏Ñ‡∏π‡πà|‡πÅ‡∏´‡∏ß‡∏ô‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå|‡πÅ‡∏´‡∏ß‡∏ô‡∏ô‡∏û‡πÄ‡∏Å‡πâ‡∏≤|‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß|‡∏•‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏ä‡∏£';
        
        // Earring types
        $earringTypes = '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏´‡πà‡∏ß‡∏á|‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏ï‡∏∏‡πâ‡∏°|‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏£‡∏∞‡∏¢‡πâ‡∏≤|‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß';
        
        $pattern = '/(' . $watchModels . '|' . $chainPatterns . '|' . $amuletTypes . '|' . $famousMonks . '|' . $famousTemples . '|' . $ringTypes . '|' . $earringTypes . ')/iu';
        return (bool)preg_match($pattern, $text);
    }
    
    /**
     * Check if text contains luxury item nicknames
     * ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ + ‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö
     */
    public function containsLuxuryNickname(string $text): bool
    {
        // Watch nicknames
        $watchNicknames = '‡πÅ‡∏û‡∏°|pam|green sub|hulk|‡∏Æ‡∏±‡∏•‡∏Ñ‡πå|pepsi|‡πÄ‡∏õ‡πä‡∏õ‡∏ã‡∏µ‡πà|batman|‡πÅ‡∏ö‡∏ó‡πÅ‡∏°‡∏ô';
        $watchNicknames .= '|root beer|‡∏£‡∏π‡∏ó‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå|starbuck|starbucks|‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ö‡∏±‡∏Ñ|panda|‡πÅ‡∏û‡∏ô‡∏î‡πâ‡∏≤';
        $watchNicknames .= '|coke|‡πÇ‡∏Ñ‡πâ‡∏Å|kermit|‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ó|wimbledon|‡∏ß‡∏¥‡∏°‡πÄ‡∏ö‡∏¥‡∏•‡∏î‡∏±‡∏ô';
        
        // Luxury bag nicknames
        $bagNicknames = 'king size|boyy|kelly|birkin|constance|j12';
        
        // Thai jewelry terms
        $thaiTerms = '‡∏ó‡∏≠‡∏áK|‡∏ó‡∏≠‡∏á18k|‡∏ó‡∏≠‡∏á14k|‡∏ó‡∏≠‡∏á9k|‡πÇ‡∏£‡∏™‡πÇ‡∏Å‡∏•‡∏î‡πå|‡∏ó‡∏π‡πÇ‡∏ó‡∏ô|‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥';
        $thaiTerms .= '|‡∏à‡∏π‡∏ö‡∏¥‡∏•‡∏µ‡πà|‡∏≠‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ö‡∏£‡∏≤‡πÄ‡∏ã‡πÄ‡∏•‡πá‡∏ï|‡πÄ‡∏ó‡∏ô‡∏ô‡∏¥‡∏™|‡∏ö‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏•';
        $thaiTerms .= '|‡∏Å‡∏∞‡∏£‡∏±‡∏ï|‡∏ï‡∏±‡∏á‡∏Ñ‡πå|‡∏™‡∏•‡∏∂‡∏á|‡∏ö‡∏≤‡∏ó‡∏ó‡∏≠‡∏á';
        
        $pattern = '/(' . $watchNicknames . '|' . $bagNicknames . '|' . $thaiTerms . ')/iu';
        return (bool)preg_match($pattern, $text);
    }
    
    /**
     * Get product indicator keywords
     * ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏Æ‡∏á‡πÄ‡∏Æ‡∏á: ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤, ‡πÅ‡∏´‡∏ß‡∏ô, ‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠, ‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠, ‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π, ‡∏à‡∏µ‡πâ, ‡∏û‡∏£‡∏∞, ‡∏ï‡∏•‡∏±‡∏ö‡∏û‡∏£‡∏∞
     */
    public function getProductIndicators(): array
    {
        return [
            // ===== ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ =====
            '‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤', '‡πÅ‡∏´‡∏ß‡∏ô', '‡∏™‡∏£‡πâ‡∏≠‡∏¢', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠', '‡∏Å‡∏≥‡πÑ‡∏•', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π', '‡∏à‡∏µ‡πâ', 
            '‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤', '‡∏û‡∏£‡∏∞', '‡∏û‡∏£‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á', '‡∏ï‡∏•‡∏±‡∏ö‡∏û‡∏£‡∏∞', '‡πÄ‡∏Ç‡πá‡∏°‡∏Ç‡∏±‡∏î', '‡πÅ‡∏ß‡πà‡∏ô',
            
            // ===== ‡∏ß‡∏±‡∏™‡∏î‡∏∏ =====
            '‡∏ó‡∏≠‡∏á', '‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥', '‡∏ó‡∏≠‡∏áK', '‡∏ó‡∏≠‡∏á18k', '‡∏ó‡∏≠‡∏á14k', '‡∏ó‡∏≠‡∏á9k', 
            '‡πÄ‡∏á‡∏¥‡∏ô', '‡πÄ‡∏û‡∏ä‡∏£', '‡πÅ‡∏û‡∏•‡∏ó‡∏¥‡∏ô‡∏±‡∏°', '‡∏´‡∏ô‡∏±‡∏á', '‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å', '‡∏û‡∏•‡∏≠‡∏¢', '‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°', '‡∏°‡∏£‡∏Å‡∏ï', '‡πÑ‡∏û‡∏•‡∏¥‡∏ô',
            
            // ===== ‡∏™‡∏µ =====
            '‡∏™‡∏µ‡∏ó‡∏≠‡∏á', '‡∏™‡∏µ‡πÄ‡∏á‡∏¥‡∏ô', '‡∏™‡∏µ‡∏î‡∏≥', '‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß', '‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', '‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß', '‡∏™‡∏µ‡πÅ‡∏î‡∏á', 
            '‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π', '‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á', '‡∏™‡∏µ‡∏™‡πâ‡∏°', '‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•', '‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á', '‡∏™‡∏µ‡πÇ‡∏£‡∏™‡πÇ‡∏Å‡∏•‡∏î‡πå', '‡πÇ‡∏£‡∏™‡πÇ‡∏Å‡∏•‡∏î‡πå', 'rose gold',
            'two tone', '‡∏ó‡∏π‡πÇ‡∏ó‡∏ô', '‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥',
            
            // ===== ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ =====
            'rolex', '‡πÇ‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏ã‡πå', 'omega', '‡πÇ‡∏≠‡πÄ‡∏°‡∏Å‡πâ‡∏≤', 'tag heuer', 'tagheuer', '‡πÅ‡∏ó‡πá‡∏Å‡∏Æ‡∏≠‡∏¢‡πÄ‡∏≠‡∏≠‡∏£‡πå',
            'patek', 'patek philippe', '‡∏õ‡∏≤‡πÄ‡∏ï‡πá‡∏Å', 'cartier', '‡∏Ñ‡∏≤‡∏£‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏£‡πå',
            'audemars', 'ap', '‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏°‡∏≤‡∏£‡πå', 'richard mille', '‡∏£‡∏¥‡∏ä‡∏≤‡∏£‡πå‡∏î ‡∏°‡∏¥‡∏•‡∏•‡πå',
            'hublot', '‡∏≠‡∏π‡πÇ‡∏ö‡∏•‡∏ï‡πå', 'iwc', 'panerai', '‡∏û‡∏≤‡πÄ‡∏ô‡∏≠‡πÑ‡∏£', 'breitling', '‡πÑ‡∏ö‡∏£‡∏ó‡πå‡∏•‡∏¥‡πà‡∏á',
            'tudor', '‡∏ó‡∏¥‡∏ß‡∏î‡∏≠‡∏£‡πå', 'longines', '‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏™‡πå', 'tissot', '‡∏ó‡∏¥‡∏™‡πÇ‡∏ã‡∏ï‡πå',
            'seiko', '‡πÑ‡∏ã‡πÇ‡∏Å‡πâ', 'citizen', '‡∏ã‡∏¥‡∏ï‡∏¥‡πÄ‡∏ã‡πà‡∏ô', 'casio', '‡∏Ñ‡∏≤‡∏™‡∏¥‡πÇ‡∏≠', 'g-shock', '‡∏à‡∏µ‡∏ä‡πá‡∏≠‡∏Ñ',
            'chopard', '‡πÇ‡∏ä‡∏û‡∏≤‡∏£‡πå‡∏î',
            
            // ===== ‡∏£‡∏∏‡πà‡∏ô‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏° =====
            'submariner', '‡∏ã‡∏±‡∏ö‡∏°‡∏≤‡∏£‡∏µ‡∏ô', 'daytona', '‡πÄ‡∏î‡∏¢‡πå‡πÇ‡∏ó‡∏ô‡πà‡∏≤', 'datejust', '‡πÄ‡∏î‡∏ó‡∏à‡∏±‡∏™‡∏ï‡πå',
            'gmt', 'gmt master', 'speedmaster', '‡∏™‡∏õ‡∏µ‡∏î‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå', 'seamaster', '‡∏ã‡∏µ‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå',
            'nautilus', '‡∏ô‡∏≠‡∏ï‡∏¥‡∏•‡∏∏‡∏™', 'royal oak', '‡∏£‡∏≠‡∏¢‡∏±‡∏•‡πÇ‡∏≠‡πä‡∏Ñ', 'aquanaut', '‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏ô‡πá‡∏≠‡∏ó',
            'oyster', '‡∏≠‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', 'perpetual', 'chronograph', '‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü',
            'explorer', '‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡∏û‡∏•‡∏≠‡πÄ‡∏£‡∏≠‡∏£‡πå', 'yacht master', '‡∏¢‡∏≠‡∏ä‡∏ó‡πå‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå',
            'sky dweller', '‡∏™‡∏Å‡∏≤‡∏¢‡∏î‡πÄ‡∏ß‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå', 'day date', '‡πÄ‡∏î‡∏¢‡πå‡πÄ‡∏î‡∏ó', 'president', '‡πÄ‡∏û‡∏£‡∏™‡∏ã‡∏¥‡πÄ‡∏î‡∏ô‡∏ó‡πå',
            
            // ===== ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ =====
            'hulk', '‡∏Æ‡∏±‡∏•‡∏Ñ‡πå', 'pepsi', '‡πÄ‡∏õ‡πä‡∏õ‡∏ã‡∏µ‡πà', 'batman', '‡πÅ‡∏ö‡∏ó‡πÅ‡∏°‡∏ô', 'coke', '‡πÇ‡∏Ñ‡πâ‡∏Å',
            'root beer', '‡∏£‡∏π‡∏ó‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå', 'panda', '‡πÅ‡∏û‡∏ô‡∏î‡πâ‡∏≤', 'starbucks', '‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ö‡∏±‡∏Ñ',
            'kermit', '‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ó', 'wimbledon', '‡∏ß‡∏¥‡∏°‡πÄ‡∏ö‡∏¥‡∏•‡∏î‡∏±‡∏ô',
            
            // ===== ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ =====
            '‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏î', '‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏î‡∏î‡∏≥', '‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏î‡∏Ç‡∏≤‡∏ß', '‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏î‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', '‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏î‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß',
            '‡∏™‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏á', '‡∏™‡∏≤‡∏¢‡πÄ‡∏´‡∏•‡πá‡∏Å', '‡∏™‡∏≤‡∏¢‡∏¢‡∏≤‡∏á', '‡∏™‡∏≤‡∏¢‡∏à‡∏π‡∏ö‡∏¥‡∏•‡∏µ‡πà', '‡∏™‡∏≤‡∏¢‡∏≠‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå',
            '‡∏≠‡∏≠‡πÇ‡∏ï‡πâ', 'automatic', '‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡πÇ‡∏ï‡πâ', '‡πÑ‡∏Ç‡∏•‡∏≤‡∏ô', 'quartz', '‡∏Ñ‡∏ß‡∏≠‡∏ï‡∏ã‡πå',
            '‡∏Ç‡∏ô‡∏≤‡∏î', '‡∏°‡∏¥‡∏•', 'mm', '36mm', '40mm', '41mm', '42mm', '44mm',
            
            // ===== ‡πÅ‡∏´‡∏ß‡∏ô =====
            '‡πÅ‡∏´‡∏ß‡∏ô‡πÄ‡∏û‡∏ä‡∏£', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ó‡∏≠‡∏á', '‡πÅ‡∏´‡∏ß‡∏ô‡∏´‡∏°‡∏±‡πâ‡∏ô', '‡πÅ‡∏´‡∏ß‡∏ô‡πÅ‡∏ï‡πà‡∏á‡∏á‡∏≤‡∏ô', '‡πÅ‡∏´‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô',
            '‡πÅ‡∏´‡∏ß‡∏ô‡∏û‡∏•‡∏≠‡∏¢', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°', '‡πÅ‡∏´‡∏ß‡∏ô‡∏°‡∏£‡∏Å‡∏ï', '‡πÅ‡∏´‡∏ß‡∏ô‡πÑ‡∏û‡∏•‡∏¥‡∏ô',
            '‡πÅ‡∏´‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á', '‡πÅ‡∏´‡∏ß‡∏ô‡∏Ñ‡∏π‡πà', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ô‡∏¥‡πâ‡∏ß‡∏Å‡πâ‡∏≠‡∏¢', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ô‡∏¥‡πâ‡∏ß‡∏ä‡∏µ‡πâ',
            '‡∏Å‡∏∞‡∏£‡∏±‡∏ï', 'ct', 'carat', '‡∏ï‡∏±‡∏á‡∏Ñ‡πå', '‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß', '‡∏•‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏ä‡∏£', '‡πÄ‡∏û‡∏ä‡∏£‡∏•‡πâ‡∏≠‡∏°',
            '‡πÅ‡∏´‡∏ß‡∏ô‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå', '‡πÅ‡∏´‡∏ß‡∏ô‡∏ô‡∏û‡πÄ‡∏Å‡πâ‡∏≤',
            
            // ===== ‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠ =====
            '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡∏≠‡∏á', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏ä‡∏£', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠‡∏ó‡∏≠‡∏á', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠‡πÄ‡∏û‡∏ä‡∏£',
            '‡∏•‡∏≤‡∏¢‡πÇ‡∏ã‡πà', '‡∏•‡∏≤‡∏¢‡∏™‡∏µ‡πà‡πÄ‡∏™‡∏≤', '‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡∏á‡∏π', '‡∏•‡∏≤‡∏¢‡∏ö‡∏≤‡∏£‡πå', '‡∏•‡∏≤‡∏¢‡∏ï‡∏∞‡∏Ç‡∏≠', '‡∏•‡∏≤‡∏¢‡πÇ‡∏≠‡πà‡∏á',
            '‡∏•‡∏≤‡∏¢‡πÄ‡∏ö‡∏ô‡∏ã‡πå', '‡∏•‡∏≤‡∏¢‡∏ã‡∏µ‡∏ï‡∏£‡∏≠‡∏á', '‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏¥‡πà‡∏á', '‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡∏µ‡∏¢', '‡∏•‡∏≤‡∏¢‡∏ö‡∏¥‡∏î',
            '‡∏Å‡∏£‡∏±‡∏°', '‡∏ö‡∏≤‡∏ó', '‡∏™‡∏•‡∏∂‡∏á', '‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏™‡∏•‡∏∂‡∏á', '1‡∏ö‡∏≤‡∏ó', '2‡∏ö‡∏≤‡∏ó', '5‡∏ö‡∏≤‡∏ó',
            
            // ===== ‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠ =====
            '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠‡∏ó‡∏≠‡∏á', '‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏ä‡∏£', '‡∏Å‡∏≥‡πÑ‡∏•‡∏ó‡∏≠‡∏á', '‡∏Å‡∏≥‡πÑ‡∏•‡πÄ‡∏û‡∏ä‡∏£',
            '‡∏Å‡∏≥‡πÑ‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠', '‡∏™‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏∑‡∏≠', '‡πÄ‡∏ó‡∏ô‡∏ô‡∏¥‡∏™', 'tennis bracelet', '‡∏ö‡∏±‡∏á‡πÄ‡∏Å‡∏¥‡∏•', 'bangle',
            
            // ===== ‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π =====
            '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏ó‡∏≠‡∏á', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡πÄ‡∏û‡∏ä‡∏£', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏û‡∏•‡∏≠‡∏¢', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å',
            '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏´‡πà‡∏ß‡∏á', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏ï‡∏∏‡πâ‡∏°', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏£‡∏∞‡∏¢‡πâ‡∏≤', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß',
            '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢', '‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏π‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á',
            
            // ===== ‡∏à‡∏µ‡πâ =====
            '‡∏à‡∏µ‡πâ‡∏ó‡∏≠‡∏á', '‡∏à‡∏µ‡πâ‡πÄ‡∏û‡∏ä‡∏£', '‡∏à‡∏µ‡πâ‡∏û‡∏•‡∏≠‡∏¢', '‡∏à‡∏µ‡πâ‡∏û‡∏£‡∏∞', '‡∏à‡∏µ‡πâ‡∏´‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠',
            '‡∏à‡∏µ‡πâ‡∏´‡∏±‡∏ß‡πÉ‡∏à', '‡∏à‡∏µ‡πâ‡∏Å‡∏≤‡∏Å‡∏ö‡∏≤‡∏ó', '‡∏à‡∏µ‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£', '‡∏à‡∏µ‡πâ‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå',
            
            // ===== ‡∏û‡∏£‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á & ‡∏ï‡∏•‡∏±‡∏ö‡∏û‡∏£‡∏∞ =====
            '‡∏û‡∏£‡∏∞‡∏ó‡∏≠‡∏á', '‡∏û‡∏£‡∏∞‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏≠‡∏á', '‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ó‡∏≠‡∏á', '‡∏Å‡∏£‡∏≠‡∏ö‡∏ó‡∏≠‡∏á', '‡∏ï‡∏•‡∏±‡∏ö‡∏ó‡∏≠‡∏á',
            
            // ‡∏û‡∏£‡∏∞‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏° (‡πÄ‡∏ö‡∏ç‡∏à‡∏†‡∏≤‡∏Ñ‡∏µ + ‡∏û‡∏£‡∏∞‡∏î‡∏±‡∏á)
            '‡∏û‡∏£‡∏∞‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à', '‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à', '‡∏û‡∏£‡∏∞‡∏õ‡∏¥‡∏î‡∏ï‡∏≤', '‡∏õ‡∏¥‡∏î‡∏ï‡∏≤', '‡∏û‡∏£‡∏∞‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô', '‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô',
            '‡∏û‡∏£‡∏∞‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤', '‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤', '‡∏û‡∏£‡∏∞‡∏£‡∏≠‡∏î', '‡∏û‡∏£‡∏∞‡∏ã‡∏∏‡πâ‡∏°‡∏Å‡∏≠', '‡∏û‡∏£‡∏∞‡∏ú‡∏á‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì',
            '‡∏û‡∏£‡∏∞‡∏Å‡∏£‡∏¥‡πà‡∏á', '‡∏Å‡∏£‡∏¥‡πà‡∏á', '‡∏û‡∏£‡∏∞‡∏ä‡∏±‡∏¢‡∏ß‡∏±‡∏í‡∏ô‡πå', '‡∏û‡∏£‡∏∞‡∏Å‡∏•‡∏µ‡∏ö‡∏ö‡∏±‡∏ß', '‡∏û‡∏£‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏•‡∏Å',
            '‡∏û‡∏£‡∏∞‡∏û‡∏∏‡∏ó‡∏ò‡∏ä‡∏¥‡∏ô‡∏£‡∏≤‡∏ä', '‡∏ä‡∏¥‡∏ô‡∏£‡∏≤‡∏ä', '‡∏û‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏£‡∏Å‡∏ï', 
            
            // ‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà/‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏î‡∏±‡∏á
            '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ó‡∏ß‡∏î', '‡∏ó‡∏ß‡∏î', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ó‡∏¥‡∏°', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏´‡∏°‡∏∏‡∏ô',
            '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏î‡∏π‡πà', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡πÄ‡∏à‡∏∑‡∏≠', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏ö‡∏∏‡∏ç', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏´‡∏•‡∏¥‡∏ß', '‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà‡∏®‡∏∏‡∏Ç',
            '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏Ñ‡∏π‡∏ì', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÄ‡∏á‡∏¥‡∏ô', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÇ‡∏™‡∏ò‡∏£', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏ß‡∏±‡∏î‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏´‡∏•‡∏°',
            '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏û‡∏£‡∏´‡∏°', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏Å‡∏ß‡∏¢', '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏£‡∏ß‡∏¢',
            '‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠‡∏ó‡∏ß‡∏î', '‡∏õ‡∏π‡πà‡∏ó‡∏ß‡∏î', '‡∏û‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢', '‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡πÇ‡∏ï', '‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏£',
            
            // ‡∏ß‡∏±‡∏î‡∏î‡∏±‡∏á
            '‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏Ü‡∏±‡∏á', '‡∏ß‡∏±‡∏î‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥', '‡∏ß‡∏±‡∏î‡πÄ‡∏Å‡∏®‡πÑ‡∏ä‡πÇ‡∏¢', '‡∏ß‡∏±‡∏î‡πÉ‡∏´‡∏ç‡πà', '‡∏ß‡∏±‡∏î‡∏ô‡∏≤‡∏á‡∏û‡∏ç‡∏≤',
            '‡∏ß‡∏±‡∏î‡∏ä‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ', '‡∏ß‡∏±‡∏î‡∏û‡∏£‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏', '‡∏ß‡∏±‡∏î‡∏ö‡∏≤‡∏á‡∏Ç‡∏∏‡∏ô‡∏û‡∏£‡∏´‡∏°', '‡∏ß‡∏±‡∏î‡∏£‡∏≤‡∏ä‡∏ö‡∏û‡∏¥‡∏ò',
            '‡∏ß‡∏±‡∏î‡∏™‡∏∏‡∏ó‡∏±‡∏®‡∏ô‡πå', '‡∏ß‡∏±‡∏î‡∏ö‡∏ß‡∏£‡∏ô‡∏¥‡πÄ‡∏ß‡∏®', '‡∏ß‡∏±‡∏î‡∏û‡∏•‡∏±‡∏ö', '‡∏ß‡∏±‡∏î‡∏´‡∏ô‡∏≠‡∏á‡πÇ‡∏û', '‡∏ß‡∏±‡∏î‡∏ó‡πà‡∏≤‡∏ã‡∏∏‡∏á',
            
            // ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
            '‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç', '‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏´‡∏•‡∏ß‡∏á‡∏û‡πà‡∏≠', '‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏´‡∏•‡∏ß‡∏á‡∏õ‡∏π‡πà', '‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏£‡∏∏‡πà‡∏ô‡πÅ‡∏£‡∏Å',
            '‡∏£‡∏∏‡πà‡∏ô‡πÅ‡∏£‡∏Å', '‡∏£‡∏∏‡πà‡∏ô‡∏™‡∏≠‡∏á', '‡∏£‡∏∏‡πà‡∏ô‡∏™‡∏≤‡∏°', '‡∏£‡∏∏‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©', '‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå5',
            
            // ‡∏û‡∏¥‡∏°‡∏û‡πå/‡πÄ‡∏ô‡∏∑‡πâ‡∏≠
            '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ô‡∏¥‡∏¢‡∏°', '‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà', '‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å', '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏•‡∏≤‡∏á', '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏£‡∏á‡πÄ‡∏à‡∏î‡∏µ‡∏¢‡πå',
            '‡πÄ‡∏ö‡∏ç‡∏à‡∏†‡∏≤‡∏Ñ‡∏µ', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ú‡∏á', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏î‡∏¥‡∏ô', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ä‡∏¥‡∏ô', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ô‡∏ß‡πÇ‡∏•‡∏´‡∏∞',
            '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏á‡∏¥‡∏ô', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡∏£‡∏¥‡∏î', '‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ß‡πà‡∏≤‡∏ô',
            
            // ‡∏ï‡∏•‡∏±‡∏ö/‡∏Å‡∏£‡∏≠‡∏ö‡∏û‡∏£‡∏∞
            '‡∏ï‡∏•‡∏±‡∏ö‡∏û‡∏£‡∏∞', '‡∏Å‡∏£‡∏≠‡∏ö‡∏û‡∏£‡∏∞', '‡∏ï‡∏•‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô', '‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏á‡∏¥‡∏ô', '‡∏ï‡∏•‡∏±‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥',
            '‡∏™‡∏≤‡∏¢‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏û‡∏£‡∏∞', '‡∏™‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏¢‡∏û‡∏£‡∏∞', '‡πÇ‡∏ã‡πà‡∏û‡∏£‡∏∞',
            
            // ===== ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö =====
            'gucci', '‡∏Å‡∏∏‡∏ä‡∏ä‡∏µ‡πà', 'lv', 'louis vuitton', '‡∏´‡∏•‡∏∏‡∏¢‡∏™‡πå', 'chanel', '‡∏ä‡∏≤‡πÅ‡∏ô‡∏•',
            'hermes', '‡πÅ‡∏≠‡∏£‡πå‡πÄ‡∏°‡∏™', 'tiffany', '‡∏ó‡∏¥‡∏ü‡∏ü‡∏≤‡∏ô‡∏µ‡πà', 'bvlgari', 'bulgari', '‡∏ö‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏µ',
            'van cleef', '‡πÅ‡∏ß‡∏ô‡∏Ñ‡∏•‡∏µ‡∏ü', 'piaget', '‡πÄ‡∏û‡∏µ‡∏¢‡πÄ‡∏à‡∏ï‡πå', 'dior', '‡∏î‡∏¥‡∏≠‡∏≠‡∏£‡πå',
            'pandora', '‡πÅ‡∏û‡∏ô‡∏î‡∏≠‡∏£‡πà‡∏≤', 'swarovski', '‡∏™‡∏ß‡∏≤‡∏£‡∏≠‡∏ü‡∏™‡∏Å‡∏µ‡πâ',
        ];
    }
    
    /**
     * Check if text is a greeting
     */
    public function isGreeting(string $text): bool
    {
        return (bool)preg_match('/^(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ|‡∏î‡∏µ|hello|hi|hey|‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì|‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à|thanks|bye|‡∏ö‡∏≤‡∏¢)[\s!‡∏Ñ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏∞‡∏Ñ‡∏∞‡∏à‡πâ‡∏≤‡∏ô‡∏∞]*$/iu', trim($text));
    }
    
    /**
     * Normalize whitespace in text
     */
    public function normalizeWhitespace(string $text): string
    {
        return trim(preg_replace('/\s+/', ' ', $text));
    }
}
