# üö® CRITICAL PROJECT RULES - ‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!

## ‚ö†Ô∏è ‡∏Å‡∏é‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î

---

## 1. üè¢ User Roles - ‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£

| Role | ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£ | ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Path | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|------|--------|-------------|----------|
| **Super Admin** | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö/Developer | `/admin/` | ‡∏î‡∏π logs, ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ subscription plans |
| **Users (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)** | ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö | `/public/` ‡∏´‡∏£‡∏∑‡∏≠ root | ‡∏î‡∏π cases, orders, pawns ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á |
| **End Customer** | ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô | Chat (LINE/Facebook) | ‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á ‡∏à‡∏≥‡∏ô‡∏≥ |

### ‚ùå ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥:
```
‚ùå ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Super Admin ‡πÑ‡∏õ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤ /admin/cases.php ‡∏´‡∏£‡∏∑‡∏≠ /admin/pawns.php
‚ùå ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ /admin/ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (cases, orders, pawns, payments)
‚ùå ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô" ‡∏ß‡πà‡∏≤ "admin"
```

### ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:
```
‚úÖ cases.php, pawns.php, orders.php ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô /public/ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)
‚úÖ /admin/ ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ super admin ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö (subscription, system logs, users)
‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô" ‡∏ß‡πà‡∏≤ "users" ‡∏´‡∏£‡∏∑‡∏≠ "shop owner"
```

---

## 2. üìÇ Directory Structure

```
/admin/              ‚Üí Super Admin ONLY (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô)
  ‚îú‚îÄ‚îÄ dashboard.php  ‚Üí System overview
  ‚îú‚îÄ‚îÄ users.php      ‚Üí ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ users (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)
  ‚îú‚îÄ‚îÄ subscriptions/ ‚Üí ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ plans
  ‚îî‚îÄ‚îÄ system/        ‚Üí System settings

/public/             ‚Üí Shop Owners (Users) - ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
  ‚îú‚îÄ‚îÄ cases.php      ‚Üí ‡∏î‡∏π/‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ cases ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
  ‚îú‚îÄ‚îÄ orders.php     ‚Üí ‡∏î‡∏π/‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ orders ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
  ‚îú‚îÄ‚îÄ pawns.php      ‚Üí ‡∏î‡∏π/‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ pawns ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
  ‚îú‚îÄ‚îÄ payments.php   ‚Üí ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
  ‚îú‚îÄ‚îÄ products.php   ‚Üí ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  ‚îî‚îÄ‚îÄ settings.php   ‚Üí ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏ô

/api/v2/             ‚Üí API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Users (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)
  ‚îú‚îÄ‚îÄ cases.php      ‚Üí Cases ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (filtered by user_id)
  ‚îú‚îÄ‚îÄ orders.php     ‚Üí Orders ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (filtered by user_id)
  ‚îî‚îÄ‚îÄ pawns.php      ‚Üí Pawns ‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (filtered by user_id)
```

---

## 3. üîê Data Isolation

‡∏ó‡∏∏‡∏Å query ‡∏ï‡πâ‡∏≠‡∏á filter ‡∏î‡πâ‡∏ß‡∏¢ `user_id` ‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô:

```php
// ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á - Filter by user_id
$cases = $db->query("SELECT * FROM cases WHERE user_id = ?", [$userId]);

// ‚ùå ‡∏ú‡∏¥‡∏î - ‡∏î‡∏∂‡∏á‡∏ó‡∏∏‡∏Å record (‡∏°‡∏µ‡πÅ‡∏ï‡πà super admin ‡∏ó‡∏≥‡πÑ‡∏î‡πâ)
$cases = $db->query("SELECT * FROM cases");
```

---

## 4. üìã Entity Ownership

| Entity | ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÉ‡∏Ñ‡∏£ | Filter By |
|--------|-----------|-----------|
| cases | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| orders | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| pawns | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| payments | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| products | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| customer_channels | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` |
| customer_profiles | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (user) | `user_id` (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô) |

---

## 5. üß™ Testing Guidelines

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö flow ‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ URL ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```bash
# ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô (Users) ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
- Cases:    /public/cases.php
- Orders:   /public/orders.php
- Pawns:    /public/pawns.php
- Payments: /public/payment-history.php

# API v2 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö frontend ‡∏Ç‡∏≠‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô):
- GET /api/v2/cases.php
- GET /api/v2/orders.php
- GET /api/v2/pawns.php
```

---

## 6. üìù Terminology

| ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ | ‚úÖ ‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô |
|-----------|----------|
| "Admin ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤ cases" | "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤ cases" |
| "/admin/cases.php" | "/public/cases.php" |
| "Admin Panel" (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô) | "Shop Dashboard" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô" |

---

## 7. üîÑ Flow Ownership

```
End Customer (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô)
    ‚Üì ‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó
Bot Handler (RouterV1/V2/V4)
    ‚Üì ‡∏™‡∏£‡πâ‡∏≤‡∏á case, order
Data (cases, orders, pawns)
    ‚Üì ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á
Shop Owner (Users/‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)
    ‚Üì ‡∏î‡∏π‡∏ú‡πà‡∏≤‡∏ô
/public/ Dashboard + /api/v2/
```

---

## ‚ö° Quick Reference

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á cases, orders, pawns, payments:**
- Owner = Users (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô)
- View = `/public/` NOT `/admin/`
- API = `/api/v2/` with user_id filter

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á system config, subscriptions, all users:**
- Owner = Super Admin
- View = `/admin/`
- API = `/api/admin/` (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

---

*‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 2026-01-31*
*‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Autobot project ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á*
